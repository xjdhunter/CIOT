### 从加法到减法
> 现实中，华为的开发流程管理是一个做加法的过程，每当觉得某个地方可能有质量隐患，那么就加一个工具，加一个流程，加一层审计，殊不知，每多加一个流程，多加一个工具，这个流程和这个工具自身就会引入新的隐患点，而且会更多。

[图三](https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1553537285821&di=af04656f551bb2c2854a14f045d4d47c&imgtype=0&src=http%3A%2F%2F5b0988e595225.cdn.sohucs.com%2Fimages%2F20170927%2Ff720e18b8bac4681a7b24a0608d2e0f8.jpeg)

> 你把一个立方体砍掉一个角，难道就从8个角变成7个角么？不是，是多出了2个角，变成了10个角。我们的开发流程管理越来越类似砍角游戏了。正确的方式应该是从加法变成减法：

> 从一个工程师的角度来说，软件开发流程的核心是如何能够让工程师尽可能减少非代码开发以外的操作和时间。工程师的非代码操作时间越多，空间越大，效率越就低，就越容易出错。如果工程师每写一行代码，都需要搬出一本书的流程来一项项梳理自己的做法是否正确，把这个工程师出错的概率乘以8万，我们自己都可以想象到出错的概率有多大。

> 什么是非代码操作：
* 写文档。
* 维护版本分支。
* 操作git的tag
* 接听电话
* 手动做任何非代码的事务，比如关联代码的request ID。
* 。。
> 理论上一个完美的工程师工作模式是按照电子流接受任务以后，完成代码和在自己代码分支上的测试，提交给review。剩下的事情都不应该是码农来干预，每多一次干预，整个系统就多一份出错的概率。当码农的群体规模达到一定程度以后，系统就会逐渐失控。

> 有人可能会反驳说写文档应该是工程师的事情。我的观点是：
*      代码文档基本没有意义，除了少量提纲挈领的代码注释以外，再多的注释也无法让受众理解代码逻辑。
*      用户文档，手册，白皮书是一门学问，不是工程师能写出来的。码农是写不出优美的文档的，这个也需要专业的人事做专业的事情。码农连PPT都写不囫囵，还能指望他们写啥呢？

> 难道写文档也是一门学问了？我坚定的认为这是一门学问。我们固然需要爱因斯坦发明相对论。但是我们更需要一群高手写出教科书让本科生能理解相对论，难道让一般人去读爱因斯坦的论文么。

> 对于从加法到减法的转变，我举一个在WindRiver的例子来说明开发流程的优化。风河的开发流程也不是一夜之间梳理清楚的，也是经过一些坑以后逐步完善起来的。在很久以前，风河的工程师是可以直接操作git库的，或者说是在gate keeper的弱监督下操作git库。直到有一天：

> 一个平时大家就认为头脑不是那么清楚的工程师，解完一个bug，把代码checkin到代码库的过程中需要写comment，在comment中，这个可怜的兄弟把这个bug中附带的相关客户信息也一并写到了comment中。这个patch一入库，系统自动触发编译，构建，补丁发布等一系列动作，当然，照例，测试也没有发现这个细小的问题。结果导致comment中的信息随着patch的发布也发布给了全世界。还有什么比带着客户信息的bug fix的patch修正发布给全世界更糟糕的事情么？

> 这个可怜的工程师不幸是我部门的。我后来调整了整个部门的流程，所有的入库信息，哪怕是comment都订好了模板，同时入库的权利全都收归到gate keeper的手中，同时还专门找个一个rm(WR叫做resource management的角色)，辅助他去做这些事情，相当于两道保险。所有的工程师再也不允许直接和git库打交道。自那以后，再也没有出过这种问题。

> 这就是一种减法：
*      把码农手中的权利收缩的越小，整个系统出错的概率越低。
*       把容易出错的地方的接触面，接触人数量收缩的越小，整个系统出错的概率越低。

> 也许有人会关心这个可怜的工程师的命运，还好，我没有为难那个倒霉蛋，事发以后他还在我的那个部门，唯一的变化是我把他调到我能看见他的位子上了。

> 我认为，如果制定一个规则，很多工程师都做不到的话，这不是工程师的问题，是规则本身的问题。没办法要求所有工程师永远不手滑。

### 工具和流程陷阱
> 除了入库收口以外，在WR的流程中，还有一个非常重要的信息是开发信息也是一种重要的资源，也需要持续的数字化，可查询化，简便化。而这个的标志就是衡量指标3，开发工位是不是安安静静的。

> 无论做硬件还是做软件，华为的各个开发工位都是人声鼎沸，嘈杂异常，和菜市场的感觉差不多，除了拉通对齐端到端以外，我们开发过程和开发流程中工程师依然要不断借助电话这一原始的工具来进行交流和沟通。但不幸的是，电话完全不具备信息保留的功能。开发过程中，每多打一个电话，那么就意味着开发过程中的一份信息丢失了。意味着某些信息就留存到了某些人的脑袋里，而不是数字化了。

> 在WindRiver的时候，我也吐槽过当时公司的开发软件，不好用。但是现在回想起来，当时整个开发团队安安静静，我很多时候一天一句话都不讲，即使工程师离我一步之遥。所有的过程也是在屏幕上完成的。大家都对着屏幕工作，无须通过任何其它的手段进行沟通是开发有序化，数字化，可视化的验收标准。

> 而这一切的目标，都是在保障除了代码可回溯性以外，还要尽最大努力做到开发过程和动作的可回溯性。

> 我也说不清楚我们的研发工具体系到底出了什么问题。我曾经尝试过用我们的系统提交过代码，只记得那是一段无比艰难的旅程。后续的开发都转移到了codeclub上。

> 如果我过分抱怨我们的研发工具体系也并不合适，毕竟华为在这种体系的支撑下依然占领了世界。但是至少有如下的三个方面的原则我认为是需要重视的：
*      研发工具的设计目标是围绕可回溯行进行设计。
*      研发工具对工程师来说，不是越多越好，而是越少越好。
*       工具和工具之间的衔接不能有手动操作，哪怕只需要程序员按一个按钮，那么他也一定会按错。
> 一个工程师如果在使用研发工具中即使拥有0.0001%的5个9的高可靠性不出错，乘以8万的研发人员也是8%的错误率。

> 一个工程师如果一年只出一次错，一个60人的工程团队就会每周都出错（一年才52周）。但是把某个容易犯错的步骤收口到一个工程师，那么一年出错的概率就只剩下一次了。

> 毕竟，我们面临的下面的一种状况
[图四](http://image.huawei.com/tiny-lts/v1/images/f3b1825ed8b447dc3901_554x246.jpg@900-0-90-f.jpg)
> 公司的研发工具体系支撑了公司走向了今天的辉煌，它适应的也许是硬件开发的时代和特点，但是对程序员来说并不友好。这个大课题还是留给公司相关的专业部门来解决吧。

> 说道开发，就不得不提一下在国内总是讲西方的一个词语“底蕴”。拿我们就来讲讲软件开发的底蕴吧。

### 软件开发的底蕴
> 这是一个很抽象的概念，但实际上又非常具体，我们总是很羡慕西方顶级公司不断能做出高质量的创新的软件。很多时候讨论的结果是有“软件开发的底蕴”。但是这个所谓的底蕴到底是什么呢？

> 首先，我认同这些创造，这些伟大的软件产品是来源于西方公司深厚的软件开发底蕴。但是，我并不认为这个底蕴具有任何的神秘感，是西方公司有什么魔法的流程，魔法的工具，魔法的设计。

> WindRiver算是一个很有趣的例子，它是西方老牌传统的软件公司，规模也不大，但所谓麻雀虽小，五脏俱全。从我上面所展现的WindRiver的整个流程和工具体系，绝对看不出任何所谓的“秘密武器”，华为完全不缺乏这些东西。差的是：
*       同样的工具体系，流程规划和设计的合理性。
*       工具的精细程度，易用程度。
*       开发群体中大多数人的遵从度。
*       对软件工程化认知的理解。
> 第1，2两个因素我认为容易赶上，只要弄清楚，加上有耐性，总还是有一天能建立起来的。难的是第3点和第4点。

> 对于第3点，当一个群体中的大多数人对相关的工具，流程，体系具有普遍一致的遵从度以后，这就是底蕴，后面进入的人就会很顺利的融入这个体系中。

> 对于第4点。以工具为例，如果从博导，到公司CEO，到部门经理，到team leade都不认为做出一个非常好用的工具是一个伟大创举的时候，你如何能创造出一个伟大的改变世界开发模式的工具呢？没有一个实际好用的工具作为载体。那么多圣经般的开发哲学除了供奉在殿堂之上，还有什么意义呢？

> 从学校到公司，我整体上感觉国内将软件专业变成了一门“科学”，但我认为软件专业整体上是一门“工程学”而非“科学”。以现在大火的AI为例，AI中的算法是数学家的范畴，是“科学”，码农的专业是将这些“科学”用工程的方式翻译成一个个实用，好用的软件实体。发明这些AI算法不是码农的职责范围（数学好谁还做码农呢？），但是同样是翻译，google的tensorflow的翻译能成为世界AI软件的“范本”，这就是工程学的杰作。这种软件的工程思维和华为把软件想象成为一种“神秘科学”，要求各级软件工程师写出别人写不出来的“黑科技代码”完全不同。

> 所谓底蕴，对于软件开发，好像也不外乎这些了把。

### 总结一下
> 最后总结一下，我相信这个总结应该是所有章节中最容易的了。

> 软件质量应该围绕一个核心，三个基础衡量指标展开。

> 一个核心是：软件质量的核心是可回溯性，所有软件质量的动作都是围绕可回溯性展开，保证可回溯性。
三个指标是：
*       现网业务和源代码的完整回溯性。
*       源码库中的代码和需求输入的完整可回溯性。
*         开发过程中产生的信息的完整可回溯行。
> 具体实施中，应该围绕Git这个全球统一的开发协作平台来设计开发流程，所有的质量工具的开发应该最终是以Git为核心来进行设计。

> 软件开发的核心是：如何能够让工程师尽可能减少非代码开发以外的操作和时间

> 工程师和开发工具的关系是：工具越少越好，接触面越小越好，尽最大努力杜绝手动操作。

> 逐步建立工具化的文化认知，西方成熟的软件开发底蕴很大程度上体现为工具文化，以及构建在工具之上的流程遵从文化。

> 但是。无论是什么样的底蕴，但是无论多么好的流程，工具，认知，具体的执行者还是工程师。没有一个优秀的工程师群体，再好的工具，再好的流程，再漂亮的PPT也无法达成最后的工程目标。我们下面就来谈谈工程师吧：码农的世界
 
